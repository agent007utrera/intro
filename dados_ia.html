<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Imperial Assault - Lanzador de Dados</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

    body {
      font-family: 'Orbitron', sans-serif;
      background: radial-gradient(circle at top, #000 0%, #111 100%);
      color:#ffe81f;
      margin:0; 
      padding:20px; 
      display:flex; 
      justify-content:center;
      min-height:100vh;
    }
    .app {max-width:900px; width:100%; text-align:center}
    h1 {margin-top:0; font-size:2.2em; text-shadow:0 0 8px #ffe81f, 0 0 15px #ffcc00}
    p {color:#ffe81f;}
    .dice-select, .dice-chosen, .actions {margin-top:20px;}
    .dice-grid {display:flex; flex-wrap:wrap; gap:12px; justify-content:center}
    .die {
      width:80px; height:80px; border-radius:12px; 
      background:#000; display:flex; align-items:center; justify-content:center; 
      cursor:pointer; border:2px solid #ffe81f; position:relative;
      box-shadow:0 0 10px rgba(255,232,31,0.6);
      transition:transform 0.2s, box-shadow 0.2s;
    }
    .die:hover {transform:scale(1.08); box-shadow:0 0 20px rgba(255,232,31,0.9)}
    .die img {max-width:100%; max-height:100%; object-fit:contain}
    .die .remove {
      position:absolute; top:2px; right:2px; background:#ef4444; color:white; 
      border-radius:50%; width:20px; height:20px; display:flex; align-items:center; 
      justify-content:center; font-size:14px; font-weight:bold; cursor:pointer;
      box-shadow:0 0 6px #000;
    }
    button {
      margin:10px; padding:12px 20px; border:none; border-radius:8px; font-weight:bold; cursor:pointer;
      font-family:'Orbitron', sans-serif; letter-spacing:1px; font-size:1em;
      text-transform:uppercase; color:black; background:#ffe81f;
      box-shadow:0 0 10px rgba(255,232,31,0.7);
      transition:transform 0.2s, box-shadow 0.2s;
    }
    button:hover {transform:scale(1.05); box-shadow:0 0 20px rgba(255,232,31,1)}
  </style>
</head>
<body>
  <div class="app">
    <h1>Imperial Assault — Lanzador de Dados</h1>
    <p>Haz clic en los dados que quieras usar. Aparecerán abajo con el color correspondiente. Luego pulsa "Lanzar" para tirarlos. Haz clic en un dado elegido para eliminarlo.</p>

    <div class="dice-select">
      <h3>Elige tus dados:</h3>
      <div class="dice-grid" id="palette"></div>
    </div>

    <div class="dice-chosen">
      <h3>Dados seleccionados:</h3>
      <div class="dice-grid" id="chosen"></div>
    </div>

    <div class="actions">
      <button id="rollBtn">Lanzar</button>
      <button id="clearBtn">Limpiar</button>
    </div>
  </div>

  <script>
    const COLORS = ["rojo","verde","azul","amarillo","blanco","negro"];
    const SIDES = 6;
    let chosen = []; // {color, face, img}

    const paletteEl = document.getElementById("palette");
    const chosenEl = document.getElementById("chosen");
    const rollBtn = document.getElementById("rollBtn");
    const clearBtn = document.getElementById("clearBtn");

    // Construir paleta de dados base
    COLORS.forEach(color => {
      const el = document.createElement("div");
      el.className = "die";
      const img = document.createElement("img");
      img.src = `images/${color}1.jpg`;
      img.alt = color;
      img.onerror = () => {img.src = placeholderDataUrl(color,"?");};
      el.appendChild(img);
      el.addEventListener("click", () => {
        // al elegir, mostrar el dado base del color (color0.jpg)
        chosen.push({color, face:null, img:`images/${color}0.jpg`});
        renderChosen();
      });
      paletteEl.appendChild(el);
    });

    function renderChosen(){
      chosenEl.innerHTML="";
      chosen.forEach((d, idx) => {
        const el = document.createElement("div");
        el.className = "die";
        const img = document.createElement("img");
        img.src = d.img;
        img.alt = d.color;
        img.onerror = () => {img.src = placeholderDataUrl(d.color,d.face||"?");};
        el.appendChild(img);

        // botón de eliminar
        const rem = document.createElement("div");
        rem.className = "remove";
        rem.textContent = "×";
        rem.addEventListener("click", (e) => {
          e.stopPropagation();
          chosen.splice(idx,1);
          renderChosen();
        });
        el.appendChild(rem);

        chosenEl.appendChild(el);
      });
    }

    function rollDice(){
      chosen = chosen.map(d => {
        const face = randInt(1,SIDES);
        return {color:d.color, face, img:`images/${d.color}${face}.jpg`};
      });
      renderChosen();
    }

    function clearDice(){
      chosen = [];
      renderChosen();
    }

    function randInt(min,max){
      return Math.floor(Math.random()*(max-min+1))+min;
    }

    function placeholderDataUrl(color, face){
      const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><rect width='100%' height='100%' fill='black' /><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='yellow' font-size='20' font-family='Orbitron' font-weight='700'>${color} ${face}</text></svg>`;
      return 'data:image/svg+xml;utf8,'+encodeURIComponent(svg);
    }

    rollBtn.addEventListener("click", rollDice);
    clearBtn.addEventListener("click", clearDice);
  </script>
</body>
</html>
